>> Query 21 (Q21) <<
>> SDQL <<
Warning: Cannot find column "l_suppkey_x" in { lineitem_supplier_nation_lineitem } ['s_name', 'l_suppkey', 'l_orderkey', 'l_orderkey', 'l_suppkey']
Warning: Cannot find column "l_suppkey_y" in { lineitem_supplier_nation_lineitem } ['s_name', 'l_suppkey', 'l_orderkey', 'l_orderkey', 'l_suppkey']
Warning: Cannot find column "l_suppkey_x" in { orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem } ['s_name', 'l_suppkey', 'l_orderkey', 'o_orderkey', 'l_orderkey', 'l_partkey', 'l_suppkey', 'l_linenumber', 'l_quantity', 'l_extendedprice', 'l_discount', 'l_tax', 'l_returnflag', 'l_linestatus', 'l_shipdate', 'l_commitdate', 'l_receiptdate', 'l_shipinstruct', 'l_shipmode', 'l_comment']
Warning: Cannot find column "l_suppkey_y" in { orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem } ['s_name', 'l_suppkey', 'l_orderkey', 'o_orderkey', 'l_orderkey', 'l_partkey', 'l_suppkey', 'l_linenumber', 'l_quantity', 'l_extendedprice', 'l_discount', 'l_tax', 'l_returnflag', 'l_linestatus', 'l_shipdate', 'l_commitdate', 'l_receiptdate', 'l_shipinstruct', 'l_shipmode', 'l_comment']
>> Optimized Query <<
============================================================
f = "F"
saudiarabia = "SAUDI ARABIA"
orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_pre_ops = ord.sum(lambda x: ({x[0]: x[1]}) if (x[0].o_orderstatus == f) else (None))

lineitem_supplier_nation_build_pre_ops = li.sum(lambda x: ({x[0]: x[1]}) if (x[0].l_receiptdate > x[0].l_commitdate) else (None))

nation_0 = na.sum(lambda x: ({x[0]: x[1]}) if (x[0].n_name == saudiarabia) else (None))

nation_1 = nation_0.sum(lambda x: {x[0]: {record({"n_nationkey": x[0].n_nationkey}): True}})

supplier_nation_probe_pre_ops = nation_1.sum(lambda x: x[1])

supplier_nation_build_nest_dict = su.sum(lambda x: {x[0].s_nationkey: sr_dict({x[0]: x[1]})})

lineitem_supplier_nation_probe_pre_ops = supplier_nation_probe_pre_ops.sum(lambda x: (supplier_nation_build_nest_dict[x[0].n_nationkey].sum(lambda y: {x[0].concat(y[0]): True})
) if (supplier_nation_build_nest_dict[x[0].n_nationkey] != None) else (None))

lineitem_supplier_nation_build_nest_dict = lineitem_supplier_nation_build_pre_ops.sum(lambda x: {x[0].l_suppkey: sr_dict({x[0]: x[1]})})

lineitem_supplier_nation_0 = lineitem_supplier_nation_probe_pre_ops.sum(lambda x: (lineitem_supplier_nation_build_nest_dict[x[0].s_suppkey].sum(lambda y: {x[0].concat(y[0]): True})
) if (lineitem_supplier_nation_build_nest_dict[x[0].s_suppkey] != None) else (None))

lineitem_supplier_nation_1 = lineitem_supplier_nation_0.sum(lambda x: {x[0]: sr_dict({record({"s_name": x[0].s_name, "l_suppkey_x": x[0].l_suppkey, "l_suppkey": x[0].l_suppkey, "l_orderkey": x[0].l_orderkey}): True})})

lineitem_supplier_nation_lineitem_build_pre_ops = lineitem_supplier_nation_1.sum(lambda x: x[1])

lineitem_0 = li.sum(lambda x: ({x[0]: x[1]}) if (x[0].l_receiptdate > x[0].l_commitdate) else (None))

lineitem_1 = lineitem_0.sum(lambda x: {x[0]: sr_dict({record({"l_orderkey": x[0].l_orderkey, "l_suppkey_y": x[0].l_suppkey, "l_suppkey": x[0].l_suppkey}): True})})

lineitem_supplier_nation_lineitem_probe_pre_ops = lineitem_1.sum(lambda x: x[1])

lineitem_supplier_nation_lineitem_build_nest_dict = lineitem_supplier_nation_lineitem_build_pre_ops.sum(lambda x: {x[0].l_orderkey: sr_dict({x[0]: x[1]})})

lineitem_supplier_nation_lineitem_0 = lineitem_supplier_nation_lineitem_probe_pre_ops.sum(lambda x: (lineitem_supplier_nation_lineitem_build_nest_dict[x[0].l_orderkey].sum(lambda y: {x[0].concat(y[0]): True})
) if (lineitem_supplier_nation_lineitem_build_nest_dict[x[0].l_orderkey] != None) else (None))

lineitem_supplier_nation_lineitem_1 = lineitem_supplier_nation_lineitem_0.sum(lambda x: ({x[0]: x[1]}) if (x[0].l_suppkey_x != x[0].l_suppkey_y) else (None))

lineitem_supplier_nation_lineitem_2 = lineitem_supplier_nation_lineitem_1.sum(lambda x: {record({"l_orderkey": x[0].l_orderkey}): True})

lineitem_supplier_nation_lineitem_3 = lineitem_supplier_nation_lineitem_2.sum(lambda x: {x[0]: sr_dict({record({"s_name": x[0].s_name, "l_suppkey_y": x[0].l_suppkey, "l_suppkey": x[0].l_suppkey, "l_orderkey_y": x[0].l_orderkey, "l_orderkey": x[0].l_orderkey}): True})})

lineitem_supplier_nation_lineitem_lineitem_supplier_nation_build_pre_ops = lineitem_supplier_nation_lineitem_3.sum(lambda x: x[1])

lineitem_supplier_nation_2 = lineitem_supplier_nation_1.sum(lambda x: x[1])

lineitem_supplier_nation_3 = lineitem_supplier_nation_2.sum(lambda x: {x[0]: sr_dict({record({"s_name": x[0].s_name, "l_suppkey_x": x[0].l_suppkey, "l_suppkey": x[0].l_suppkey, "l_orderkey_x": x[0].l_orderkey, "l_orderkey": x[0].l_orderkey}): True})})

lineitem_supplier_nation_lineitem_lineitem_supplier_nation_probe_pre_ops = lineitem_supplier_nation_3.sum(lambda x: x[1])

lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_nest_dict = lineitem_supplier_nation_lineitem_lineitem_supplier_nation_build_pre_ops.sum(lambda x: {x[0].l_orderkey: sr_dict({x[0]: x[1]})})

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_probe_pre_ops = lineitem_supplier_nation_lineitem_lineitem_supplier_nation_probe_pre_ops.sum(lambda x: ({x[0]: True}) if (lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_nest_dict[x[0].l_orderkey] == None) else (None))

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_nest_dict = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_pre_ops.sum(lambda x: {x[0].o_orderkey: sr_dict({x[0]: x[1]})})

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_0 = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_probe_pre_ops.sum(lambda x: (orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_nest_dict[x[0].l_orderkey].sum(lambda y: {x[0].concat(y[0]): True})
) if (orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_nest_dict[x[0].l_orderkey] != None) else (None))

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_build_pre_ops = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_probe_pre_ops.sum(lambda x: (orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_nest_dict[x[0].l_orderkey].sum(lambda y: {x[0].concat(y[0]): True})
) if (orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_build_nest_dict[x[0].l_orderkey] != None) else (None))

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_build_nest_dict = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_build_pre_ops.sum(lambda x: {x[0].o_orderkey: sr_dict({x[0]: x[1]})})

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_0 = li.sum(lambda x: (orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_build_nest_dict[x[0].l_orderkey].sum(lambda y: {x[0].concat(y[0]): True})
) if (orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_build_nest_dict[x[0].l_orderkey] != None) else (None))

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_isin_pre_ops = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_0.sum(lambda x: ({x[0]: x[1]}) if (x[0].l_suppkey_x != x[0].l_suppkey_y) else (None))

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_isin_build_index = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_isin_pre_ops.sum(lambda x: {x[0].o_orderkey: True})

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_1 = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_0.sum(lambda x: ({x[0]: x[1]}) if (orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_lineitem_orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_isin_build_index[x[0].o_orderkey] != None) else (None))

orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_2 = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_1.sum(lambda x: {record({"s_name": x[0].s_name}): record({"numwait": (1.0) if (x[0].s_name != None) else (0.0)})})

results = orders_lineitem_supplier_nation_lineitem_supplier_nation_lineitem_2.sum(lambda x: {x[0].concat(x[1]): True})

============================================================
Reading T:/tpch_dataset/10M/supplier.tbl Finished.
Reading T:/tpch_dataset/10M/lineitem.tbl Finished.
Reading T:/tpch_dataset/10M/orders.tbl Finished.
Reading T:/tpch_dataset/10M/nation.tbl Finished.
 SDQL Execution Time: 6.999284505844116 s 
SDQL RESULTS START
============================================================
{ { "s_name": "Supplier#000000074", "numwait": 15.0 }: True }
============================================================
SDQL RESULTS END
>> Pandas <<
Pandas Execution Time: 0.1010901927947998 s 
DuckDB Execution Time: 0.050045013427734375 s 
============================================================
>> Comparing Pandas with Duck ... <<
Warning: squeeze failed
============================================================
 Check Pandas with DuckDB: Pass 
============================================================
PANDAS RESULTS START
============================================================
               s_name  numwait
0  Supplier#000000074        9
============================================================
PANDAS RESULTS END
============================================================
>> Comparing SDQL with Pandas ... <<
Warning: squeeze failed
Shape Check Passed: 1 rows x 2 columns
At row number 0 / 1
Not found {'s_name': 'Supplier#000000074', 'numwait': 15.0}
Failed while looking for numwait == 15.0
The answer is as following:
               s_name  numwait
0  Supplier#000000074        9
number of mismatch records: 1
============================================================

    
 [ [   [[[ [   [    [  [
XTTT[U   UXTTTT빠XTT[^[ X빠    ^TTTT[U
U   UU   U[  X빠 ^X빠      X빠^U
U빹빹 UU   UXTT빠  XTT[  ^X빠      XTTT빠  U
^X빠^X빠[U  U   U       [ U
 ^TT??T빠  ^TTTTT빠 ^TTTTTT빠^T빠  ^T빠   ^T빠       ^TTTTTT빠 ^T빠

             ? 빹빹빹       뺃 뺃    
           뺃   ? ?빹    뺃?뺃?    
           ? ? ?  ?빹  ????    
           ?뺃?  ? ?빹빹빹빹 ????    
           ???     뺃   뺃?????
            ? ?     ??   뺃???뺃  ? ??뺃  ?
            ?        ?   ?? ? ? ?? ? ?  ?
            ? ?      ?   ?    ? ?  ? ?   
                         ?  ? ?      ?  ?
    
============================================================
21:  Fail 
============================================================
0.14529710213343303
